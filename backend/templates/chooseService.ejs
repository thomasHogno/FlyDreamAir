<%- include('header'); %>
    <style>
        body {
          width: 100%;
          height: 100vh;
          margin: 0;
          padding: 0;
        }
        .center {
          width: 100%;
          height: 100%;
          display: flex;
          align-items: center;
          justify-content: center;
          background: linear-gradient(
            to right,
            rgb(162, 216, 162),
            rgb(102, 194, 102)
          );
        }
        .tickets {
          /* width: 550px; */
          width: auto;
          height: fit-content;
          border: 0.4mm solid rgba(0, 0, 0, 0.08);
          border-radius: 3mm;
          box-sizing: border-box;
          padding: 10px;
          font-family: poppins;
          max-height: 96vh;
          overflow: auto;
          background: white;
          box-shadow: 0px 25px 50px -12px rgba(0, 0, 0, 0.25);
        }
        .ticket-selector {
          background: rgb(243, 243, 243);
          display: flex;
          align-items: center;
          justify-content: space-between;
          flex-direction: column;
          box-sizing: border-box;
          padding: 20px;
        }
        .head {
          width: 100%;
          display: flex;
          align-items: center;
          justify-content: center;
          margin-bottom: 30px;
        }
        .title {
          font-size: 16px;
          font-weight: 600;
        }
        .seats {
          width: 100%;
          display: flex;
          align-items: center;
          justify-content: center;
          flex-direction: column;
          min-height: 150px;
          position: relative;
        }
        .status {
          width: 100%;
          display: flex;
          align-items: center;
          justify-content: space-evenly;
        }
        .seats::before {
          content: "";
          position: absolute;
          bottom: 0;
          left: 50%;
          transform: translate(-50%, 0);
          width: 220px;
          height: 7px;
          background: rgb(141, 198, 255);
          border-radius: 0 0 3mm 3mm;
          border-top: 0.3mm solid rgb(180, 180, 180);
        }
        .item {
          font-size: 12px;
          position: relative;
        }
        .item::before {
          content: "";
          position: absolute;
          top: 50%;
          left: -12px;
          transform: translate(0, -50%);
          width: 10px;
          height: 10px;
          background: rgb(255, 255, 255);
          outline: 0.2mm solid rgb(120, 120, 120);
          border-radius: 0.3mm;
        }
        .item:nth-child(2)::before {
          background: rgb(180, 180, 180);
          outline: none;
        }
        .item:nth-child(3)::before {
          background: rgb(28, 185, 120);
          outline: none;
        }
        .all-return-seats {
          display: grid;
          grid-template-columns: repeat(9, 1fr);
          grid-gap: 15px;
          margin: 60px 0;
          /* margin-top: 20px; */
          margin-top: 60px; 
          position: relative;
        }
        .all-departure-seats {
          display: grid;
          grid-template-columns: repeat(9, 1fr);
          grid-gap: 15px;
          margin: 60px 0;
          /* margin-top: 20px; */
          margin-top: 60px; 
          position: relative;
        }
        .departureSeat {
          width: 20px;
          height: 20px;
          background: white;
          border-radius: 0.5mm;
          outline: 0.3mm solid rgb(180, 180, 180);
          cursor: pointer;
        }
        .returnSeat {
          width: 20px;
          height: 20px;
          background: white;
          border-radius: 0.5mm;
          outline: 0.3mm solid rgb(180, 180, 180);
          cursor: pointer;
        }
        .all-departure-seats input:checked + label {
          background: rgb(28, 185, 120);
          outline: none;
        }
        .all-return-seats input:checked + label {
          background: rgb(28, 185, 120);
          outline: none;
        }
        .departureSeat.booked {
          background: rgb(180, 180, 180);
          outline: none;
        }
        .returnSeat.booked {
          background: rgb(180, 180, 180);
          outline: none;
        }
        input {
          display: none;
        }
        .timings {
          width: 100%;
          display: flex;
          flex-direction: column;
          align-items: center;
          justify-content: center;
          margin-top: 30px;
        }
        .dates {
          width: 100%;
          display: flex;
          align-items: center;
          justify-content: space-between;
        }
        .dates-item {
          width: 50px;
          height: 40px;
          background: rgb(233, 233, 233);
          text-align: center;
          display: flex;
          align-items: center;
          justify-content: center;
          flex-direction: column;
          padding: 10px 0;
          border-radius: 2mm;
          cursor: pointer;
        }
        .day {
          font-size: 12px;
        }
        .times {
          width: 100%;
          display: flex;
          align-items: center;
          justify-content: space-between;
          margin-top: 10px;
        }
        .time {
          font-size: 14px;
          width: fit-content;
          padding: 7px 14px;
          background: rgb(233, 233, 233);
          border-radius: 2mm;
          cursor: pointer;
        }
        .timings input:checked + label {
          background: rgb(28, 185, 120);
          color: white;
        }
        .price {
          width: 100%;
          box-sizing: border-box;
          padding: 10px 20px;
          display: flex;
          align-items: center;
          justify-content: space-between;
        }
        .total {
          display: flex;
          flex-direction: column;
          align-items: flex-start;
          justify-content: center;
          font-size: 16px;
          font-weight: 500;
        }
        .total span {
          font-size: 11px;
          font-weight: 400;
        }
        .price button {
          background: rgb(60, 60, 60);
          color: white;
          font-family: poppins;
          font-size: 14px;
          padding: 7px 14px;
          border-radius: 2mm;
          outline: none;
          border: none;
          cursor: pointer;
        }
        .baggage-options {
        margin-top: 20px;
        padding: 10px;
        border: 1px solid #ccc;
        border-radius: 5px;
    }
    .baggage-options h2 {
        margin-bottom: 10px;
    }
    .baggage-options label {
        display: flex;
        align-items: center;
        margin-bottom: 5px;
    }
    .baggage-img {
        width: 20px; /* Adjust image size */
        height: 20px;
        margin-right: 10px;
    }
    form {
        margin-top: 20px;
        padding: 10px;
        border: 1px solid #ccc;
        border-radius: 5px;
    }

    form label {
        margin-right: 10px;
    }

    form button {
        margin-top: 10px;
    }

    .services-options {
    margin-top: 20px;
}



.services-options input[type="checkbox"] + label:before {
    content: "";
    display: inline-block;
    width: 20px;
    height: 20px;
    background-color: #fff;
    border: 2px solid #aaa;
    border-radius: 4px;
    margin-right: 10px;
    vertical-align: middle;
}
/* Checkbox checked style */
.services-options input[type="checkbox"]:checked + label:before {
    background-color: #4caf50;
    border-color: #4caf50;
}

.price {
      position: sticky;
      top: 0;
      background-color: green;
      border: 2px solid #4CAF50;
      padding: 10px;
      z-index: 1000; /* Ensure it stays on top of other content */
    }
      </style>
    </head>
    <body>
      <h1>Choose your Flight Services:</h1>
      <div class="price">
        <div class="total">
        <h3 class="totalServiceFee">Total Service Fee (AUD) : <div class="amount">0</div></h3> 
        </div>
        </div>
      <form method="post" action="/chooseServices">

          <input type="text" id="totalFee" class="totalFee" name="totalFee" value="0" readonly> 

        <h1>Choose Departure Flight Services: </h1>
    <div class="center">
      <div class="tickets">
        <div class="ticket-selector">
          <div class="head">
            <div class="title">Seat Map</div>
          </div>
          <div class="seats">
            <div class="status">
              <div class="item">Available</div>
              <div class="item">Booked</div>
              <div class="item">Selected</div>
            </div>
            <div class="all-departure-seats">
              <input type="checkbox" name="departureSeat" id="s1" />
              <label for="ds1" class="seat booked"></label>
            </div>
          </div>
          <h3>Booked Seat: <span class="departure-booked-seat"></span></h3>

          <div class="baggage-options">
              <h2>Baggage Options:</h2>
              <input type="radio" name="departureBaggage" id="departure-baggage-none" value="0" checked>
              <label for="departure-baggage-none">
                  <img class="baggage-img" src="/icons/baggage.png">
                  No baggage</label><br>
              <input type="radio" name="departureBaggage" id="departure-baggage-15kg" value="15">
              <label for="departure-baggage-15kg">
                  <img class="baggage-img" src="/icons/baggage.png">
                  15kg : $15</label><br>
              <input type="radio" name="departureBaggage" id="departure-baggage-25kg" value="25">
              <label for="departure-baggage-25kg">
                  <img class="baggage-img" src="/icons/baggage.png">
                  25kg : $25</label><br>
          </div>

          <div class="food-options">
              <h2>Food & Drink :</h2>
              <input type="radio" name="departureFood" id="departure-food-none" value="0" checked>
              <label for="departure-food-none">
                  <img class="baggage-img" src="/icons/noneFood.jpg">
                  No food</label><br>
              <input type="radio" name="departureFood" id="departure-food-rice" value="10">
              <label for="departure-food-rice">
                  <img class="baggage-img" src="/icons/chicken-rice.jpg">
                  Chiken rice + free drink</label><br>
              <input type="radio" name="departureFood" id="departure-food-noodle" value="15">
              <label for="departure-food-noodle">
                  <img class="baggage-img" src="/icons/noodle.jpg">
                  Singapore Noodle + free drink</label><br>
          </div>

          <div class="services-options">
              <h2>Additional Services:</h2>
              <div> 
                  <h4>Priority Check-in:</h4> 
              <input type="checkbox" name="departurePriority" id="departure-priority-checkin-true" value="true">
                  <label for="departure-priority-checkin-true">  Priority Check-in : $50</label>
                  <input type="checkbox" name="departurePriority" id="departure-priority-checkin-false" value="false" checked style="display: none;">
              </div>
                  <br/>
              <div>
                  <h4>Insurance: </h4>
                  <input type="checkbox" name="departureInsurance" id="departure-insurance-true" value="true">
                  <label for="departure-insurance-true">Insurance : $100</label>
                  <input type="checkbox" name="departureInsurance" id="departure-insurance-false" value="false" checked style="display: none;">
              </div>
          </div>
        </div>
      </div>
    </div>
<% if(isReturnFlight){ %>
  <h1>Choose Return Flight Services: </h1>
  <div class="center">
    <div class="tickets">
      <div class="ticket-selector">
        <div class="head">
          <div class="title">Seat Map</div>
        </div>
        <div class="seats">
          <div class="status">
            <div class="item">Available</div>
            <div class="item">Booked</div>
            <div class="item">Selected</div>
          </div>
          <div class="all-return-seats">
            <input type="checkbox" name="returnSeat" id="rs1" />
            <label for="rs1" class="seat booked"></label>
          </div>
        </div>
        <h3>Booked Seat: <span class="booked-return-seat"></span></h3>

        <div class="baggage-options">
          <h2>Baggage Options:</h2>
          <input type="radio" name="returnBaggage" id="return-baggage-none" value="0" checked>
          <label for="return-baggage-none">
              <img class="baggage-img" src="/icons/baggage.png">
              No baggage</label><br>
          <input type="radio" name="returnBaggage" id="return-baggage-15kg" value="15">
          <label for="return-baggage-15kg">
              <img class="baggage-img" src="/icons/baggage.png">
              15kg : $15</label><br>
          <input type="radio" name="returnBaggage" id="return-baggage-25kg" value="25">
          <label for="return-baggage-25kg">
              <img class="baggage-img" src="/icons/baggage.png">
              25kg : $25</label><br>
      </div>

      
      <div class="food-options">
        <h2>Food & Drink :</h2>
        <input type="radio" name="returnFood" id="return-food-none" value="0" checked>
        <label for="return-food-none">
            <img class="baggage-img" src="/icons/noneFood.jpg">
            No food</label><br>
        <input type="radio" name="returnFood" id="return-food-rice" value="10">
        <label for="return-food-rice">
            <img class="baggage-img" src="/icons/chicken-rice.jpg">
            Chiken rice + free drink</label><br>
        <input type="radio" name="returnFood" id="return-food-noodle" value="15">
        <label for="return-food-noodle">
            <img class="baggage-img" src="/icons/noodle.jpg">
            Singapore Noodle + free drink</label><br>
    </div>

        <div class="services-options">
            <h2>Additional Services:</h2>
            <div> 
                <h4>Priority Check-in:</h4> 
            <input type="checkbox" name="returnPriority" id="return-priority-checkin-true" value="true">
                <label for="return-priority-checkin-true">  Priority Check-in : $50</label>
                <input type="checkbox" name="returnPriority" id="return-priority-checkin-false" value="false" checked style="display: none;">
            </div>
                <br/>
            <div>
                <h4>Insurance: </h4>
                <input type="checkbox" name="returnInsurance" id="return-insurance-true" value="true">
                <label for="return-insurance-true">Insurance : $100</label>
                <input type="checkbox" name="returnInsurance" id="return-insurance-false" value="false" checked style="display: none;">
            </div>
        </div>
      </div>
    </div>
  </div>
    <% } %>
      <button type="submit">Next</button>
  </form>
  <script>
 document.addEventListener("DOMContentLoaded", () => {
    let departureSeats = document.querySelector(".all-departure-seats");
    let bookedDepartureSeatDisplay = document.querySelector(".departure-booked-seat");
    let selectedDepartureTicket = null;
    let selectedDepartureBaggageOption = null;
    let selectedDepartureFoodOption = null;
    let selectedDeparturePriorityCheckin = null;
    let selectedDepartureInsurance = null;

    let previousDepartureSeatCost = 0;
    let previousDepartureBaggageCost = 0;
    let previousDepartureFoodCost = 0;
    let previousDeparturePriorityCheckinCost = 0;
    let previousDepartureInsuranceCost = 0;

    let returnSeats = document.querySelector(".all-return-seats");
    let bookedReturnSeatDisplay = document.querySelector(".booked-return-seat");
    let selectedReturnTicket = null;
    let selectedReturnBaggageOption = null;
    let selectedReturnFoodOption = null;
    let selectedReturnPriorityCheckin = null;
    let selectedReturnInsurance = null;

    let previousReturnSeatCost = 0;
    let previousReturnBaggageCost = 0;
    let previousReturnFoodCost = 0;
    let previousReturnPriorityCheckinCost = 0;
    let previousReturnInsuranceCost = 0;

    const updateTotalAmount = () => {
        let amount = 0;
        amount += previousDepartureSeatCost;
        amount += previousDepartureBaggageCost;
        amount += previousDepartureFoodCost;
        amount += previousDeparturePriorityCheckinCost;
        amount += previousDepartureInsuranceCost;
        amount += previousReturnSeatCost;
        amount += previousReturnBaggageCost;
        amount += previousReturnFoodCost;
        amount += previousReturnPriorityCheckinCost;
        amount += previousReturnInsuranceCost;
        document.querySelector(".amount").textContent = amount;
        document.querySelector(".totalFee").value = amount;
    };

    // Generate seat checkboxes dynamically
    for (let i = 0; i < 152; i++) {
        let randint = Math.floor(Math.random() * 2);
        let booked = randint === 1 ? "booked" : "";
        departureSeats.insertAdjacentHTML(
            "beforeend",
            `<input type="checkbox" name="departureSeat" id="ds${i + 2}" value="${i + 2}" /><label for="ds${i + 2}" class="departureSeat ${booked}"></label>`
        );
    }

    let departureTickets = departureSeats.querySelectorAll("input[name='departureSeat']");
    departureTickets.forEach((ticket) => {
        ticket.addEventListener("change", () => {
            previousDepartureSeatCost = ticket.checked ? 200 : 0;
            if (ticket.checked) {
                if (selectedDepartureTicket && selectedDepartureTicket !== ticket) {
                    selectedDepartureTicket.checked = false;
                }
                selectedDepartureTicket = ticket;
                bookedDepartureSeatDisplay.textContent = ticket.id.substring(2);
            } else {
                bookedDepartureSeatDisplay.textContent = "";
            }
            updateTotalAmount();
        });
    });

    let departureBaggageOptions = document.querySelectorAll("input[name='departureBaggage']");
    departureBaggageOptions.forEach((option) => {
        option.addEventListener("change", () => {
            previousDepartureBaggageCost = option.checked ? Number(option.value) : 0;
            selectedDepartureBaggageOption = option.checked ? option : null;
            updateTotalAmount();
        });
    });

    let departureFoodOptions = document.querySelectorAll("input[name='departureFood']");
    departureFoodOptions.forEach((option) => {
        option.addEventListener("change", () => {
            previousDepartureFoodCost = option.checked ? Number(option.value) : 0;
            selectedDepartureFoodOption = option.checked ? option : null;
            updateTotalAmount();
        });
    });

    let departurePriorityCheckinCheckbox = document.getElementById("departure-priority-checkin-true");
    departurePriorityCheckinCheckbox.addEventListener("change", () => {
        previousDeparturePriorityCheckinCost = departurePriorityCheckinCheckbox.checked ? 50 : 0;
        document.getElementById('departure-priority-checkin-false').checked = !departurePriorityCheckinCheckbox.checked;
        updateTotalAmount();
    });

    let departureInsuranceCheckbox = document.getElementById("departure-insurance-true");
    departureInsuranceCheckbox.addEventListener("change", () => {
        previousDepartureInsuranceCost = departureInsuranceCheckbox.checked ? 100 : 0;
        document.getElementById('departure-insurance-false').checked = !departureInsuranceCheckbox.checked;
        updateTotalAmount();
    });

    // Generate return seat checkboxes dynamically
    for (let i = 0; i < 152; i++) {
        let randint = Math.floor(Math.random() * 2);
        let booked = randint === 1 ? "booked" : "";
        returnSeats.insertAdjacentHTML(
            "beforeend",
            `<input type="checkbox" name="returnSeat" id="rs${i + 2}" value="${i + 2}" /><label for="rs${i + 2}" class="returnSeat ${booked}"></label>`
        );
    }

    let returnTickets = returnSeats.querySelectorAll("input[name='returnSeat']");
    returnTickets.forEach((ticket) => {
        ticket.addEventListener("change", () => {
            previousReturnSeatCost = ticket.checked ? 200 : 0;
            if (ticket.checked) {
                if (selectedReturnTicket && selectedReturnTicket !== ticket) {
                    selectedReturnTicket.checked = false;
                }
                selectedReturnTicket = ticket;
                bookedReturnSeatDisplay.textContent = ticket.id.substring(2);
            } else {
                bookedReturnSeatDisplay.textContent = "";
            }
            updateTotalAmount();
        });
    });

    let returnBaggageOptions = document.querySelectorAll("input[name='returnBaggage']");
    returnBaggageOptions.forEach((option) => {
        option.addEventListener("change", () => {
            previousReturnBaggageCost = option.checked ? Number(option.value) : 0;
            selectedReturnBaggageOption = option.checked ? option : null;
            updateTotalAmount();
        });
    });

    let returnFoodOptions = document.querySelectorAll("input[name='returnFood']");
    returnFoodOptions.forEach((option) => {
        option.addEventListener("change", () => {
            previousReturnFoodCost = option.checked ? Number(option.value) : 0;
            selectedReturnFoodOption = option.checked ? option : null;
            updateTotalAmount();
        });
    });

    let returnPriorityCheckinCheckbox = document.getElementById("return-priority-checkin-true");
    returnPriorityCheckinCheckbox.addEventListener("change", () => {
        previousReturnPriorityCheckinCost = returnPriorityCheckinCheckbox.checked ? 50 : 0;
        document.getElementById('return-priority-checkin-false').checked = !returnPriorityCheckinCheckbox.checked;
        updateTotalAmount();
    });

    let returnInsuranceCheckbox = document.getElementById("return-insurance-true");
    returnInsuranceCheckbox.addEventListener("change", () => {
        previousReturnInsuranceCost = returnInsuranceCheckbox.checked ? 100 : 0;
        document.getElementById('return-insurance-false').checked = !returnInsuranceCheckbox.checked;
        updateTotalAmount();
    });
});

           </script>
           <%- include('footer'); %>