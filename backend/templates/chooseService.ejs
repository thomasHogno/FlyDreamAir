<%- include('header'); %>

<h1>Choose your Flight Services:</h1>
<style>
    body {
        width: 100%;
        height: 100vh;
        margin: 0;
        padding: 0;
        font-family: poppins, sans-serif;
    }
    .center {
        width: 100%;
        height: 100%;
        display: flex;
        align-items: center;
        justify-content: center;
    }
    .tickets {
        width: auto;
        height: fit-content;
        border: 0.4mm solid rgba(0, 0, 0, 0.08);
        border-radius: 3mm;
        box-sizing: border-box;
        padding: 10px;
        font-family: poppins;
        max-height: 96vh;
        overflow: auto;
        background: white;
        box-shadow: 0px 25px 50px -12px rgba(0, 0, 0, 0.25);
    }
    .body-img {
    background-image: url(images/singapore.jpg);
    background-size: cover;
    background-repeat: no-repeat;
    opacity: 0.5;
    position: fixed;
    width: 100%;
    height: 100%;
    z-index: -120;
}
    .ticket-selector {
        background: rgb(243, 243, 243);
        display: flex;
        align-items: center;
        justify-content: space-between;
        flex-direction: column;
        box-sizing: border-box;
        padding: 20px;
    }
    .head {
        width: 100%;
        display: flex;
        align-items: center;
        justify-content: center;
        margin-bottom: 30px;
    }
    .title {
        font-size: 16px;
        font-weight: 600;
    }
    .seats {
        width: 100%;
        display: flex;
        align-items: center;
        justify-content: center;
        flex-direction: column;
        min-height: 150px;
        position: relative;
    }
    .status {
        width: 100%;
        display: flex;
        align-items: center;
        justify-content: space-evenly;
    }
    .seats::before {
        content: "";
        position: absolute;
        bottom: 0;
        left: 50%;
        transform: translate(-50%, 0);
        width: 220px;
        height: 7px;
        background: rgb(141, 198, 255);
        border-radius: 0 0 3mm 3mm;
        border-top: 0.3mm solid rgb(180, 180, 180);
    }
    .item {
        font-size: 12px;
        position: relative;
    }
    .item::before {
        content: "";
        position: absolute;
        top: 50%;
        left: -12px;
        transform: translate(0, -50%);
        width: 10px;
        height: 10px;
        background: rgb(255, 255, 255);
        outline: 0.2mm solid rgb(120, 120, 120);
        border-radius: 0.3mm;
    }
    .item:nth-child(2)::before {
        background: rgb(180, 180, 180);
        outline: none;
    }
    .item:nth-child(3)::before {
        background: rgb(28, 185, 120);
        outline: none;
    }
    .all-seats {
        display: grid;
        grid-template-columns: repeat(9, 1fr);
        grid-gap: 15px;
        margin: 60px 0;
        position: relative;
    }
    .seat {
        width: 20px;
        height: 20px;
        background: white;
        border-radius: 0.5mm;
        outline: 0.3mm solid rgb(180, 180, 180);
        cursor: pointer;
    }
    .all-seats input:checked + label {
        background: rgb(28, 185, 120);
        outline: none;
    }
    .seat.booked {
        background: rgb(180, 180, 180);
        outline: none;
    }
    input {
        display: none;
    }
    .timings {
        width: 100%;
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: center;
        margin-top: 30px;
    }
    .dates {
        width: 100%;
        display: flex;
        align-items: center;
        justify-content: space-between;
    }
    .dates-item {
        width: 50px;
        height: 40px;
        background: rgb(233, 233, 233);
        text-align: center;
        display: flex;
        align-items: center;
        justify-content: center;
        flex-direction: column;
        padding: 10px 0;
        border-radius: 2mm;
        cursor: pointer;
    }
    .day {
        font-size: 12px;
    }
    .times {
        width: 100%;
        display: flex;
        align-items: center;
        justify-content: space-between;
        margin-top: 10px;
    }
    .time {
        font-size: 14px;
        width: fit-content;
        padding: 7px 14px;
        background: rgb(233, 233, 233);
        border-radius: 2mm;
        cursor: pointer;
    }
    .timings input:checked + label {
        background: rgb(28, 185, 120);
        color: white;
    }
    .price {
        width: 100%;
        box-sizing: border-box;
        padding: 10px 20px;
        display: flex;
        align-items: center;
        justify-content: space-between;
    }
    .total {
        display: flex;
        flex-direction: column;
        align-items: flex-start;
        justify-content: center;
        font-size: 16px;
        font-weight: 500;
        text-align: center;
    }
    .total-text {
      text-align: center;
      align-items: center;
      transform: translate(230%);

    }

    .total span {
        font-size: 11px;
        font-weight: 400;
        text-align: center;
        text-decoration: none;
        text-align: center;
        font-size: 50px;

    }

    .booked-seat {
      text-decoration: none;
      text-align: center;
      font-size: 50px;

    }
    .price button {
        background: rgb(60, 60, 60);
        color: white;
        font-family: poppins;
        font-size: 14px;
        padding: 7px 14px;
        border-radius: 2mm;
        outline: none;
        border: none;
        cursor: pointer;
    }
    .baggage-options {
        margin-top: 20px;
        padding: 10px;
        border: 1px solid #ccc;
        border-radius: 5px;
        background: #f9f9f9;
    }
    .baggage-options h2 {
        margin-bottom: 10px;
    }
    .baggage-options label {
        display: flex;
        align-items: center;
        margin-bottom: 5px;
        cursor: pointer;
    }
    .baggage-img {
        width: 20px;
        height: 20px;
        margin-right: 10px;
    }
    .food-options {
        margin-top: 20px;
        padding: 10px;
        border: 1px solid #ccc;
        border-radius: 5px;
        background: #f9f9f9;
    }
    .food-options h2 {
        margin-bottom: 10px;
    }
    .food-options label {
        display: flex;
        align-items: center;
        margin-bottom: 5px;
        cursor: pointer;
    }
    .food-img {
        width: 20px;
        height: 20px;
        margin-right: 10px;
    }
    form {
        margin-top: 20px;
        padding: 10px;
        border: 1px solid #ccc;
        border-radius: 5px;
    }
    .services-options {
        margin-top: 20px;
        padding: 10px;
        border: 1px solid #ccc;
        border-radius: 5px;
        background: #f9f9f9;
    }
    .services-options h2 {
        margin-bottom: 10px;
    }
    .services-options label {
        display: flex;
        align-items: center;
        margin-bottom: 10px;
        cursor: pointer;
    }
    .services-options input[type="checkbox"] {
        display: none;
    }
    .services-options input[type="checkbox"] + label:before {
    content: "";
    display: inline-block;
    /* Set width and height to match the larger checkbox */
    width: 100%;
    height: 20px;
    background-color: #fff;
    border: 2px solid #aaa;
    border-radius: 4px;
    margin-right: 10px;
    vertical-align: middle;
}
    .services-options input[type="checkbox"]:checked + label:before {
        background-color: #4caf50;
        border-color: #4caf50;
    }
    .selected-option {
        border: 2px solid black;
        background-color: #4caf50;
    }
</style>

<body>
  <div class="body-img"></div>
    <form method="post" action="/chooseServices">
        <div class="center">
            <div class="tickets">
                <div class="ticket-selector">
                    <div class="head">
                        <div class="title">Seat Map</div>
                    </div>
                    <div class="seats">
                        <div class="status">
                            <div class="item">Available</div>
                            <div class="item">Booked</div>
                            <div class="item">Selected</div>
                        </div>
                        <div class="all-seats">
                            <input type="checkbox" name="seat" id="s1" />
                            <label for="s1" class="seat booked"></label>
                        </div>
                    </div>
                    <h3 class="total">Booked Seat: <span class="booked-seat"></span></h3>

                    <div class="baggage-options">
                        <h2>Baggage Options:</h2>
                        <input type="radio" name="baggage" id="baggage-none" value="0" checked>
                        <label for="baggage-none">
                            <img class="baggage-img" src="/icons/baggage.png" alt="Baggage Icon">
                            No baggage
                        </label><br>
                        <input type="radio" name="baggage" id="baggage-15kg" value="15">
                        <label for="baggage-15kg">
                            <img class="baggage-img" src="/icons/baggage.png" alt="Baggage Icon">
                            15kg : $15
                        </label><br>
                        <input type="radio" name="baggage" id="baggage-25kg" value="25">
                        <label for="baggage-25kg">
                            <img class="baggage-img" src="/icons/baggage.png" alt="Baggage Icon">
                            25kg : $25
                        </label><br>
                    </div>

                    <div class="food-options">
                        <h2>Food & Drink :</h2>
                        <input type="radio" name="food" id="food-none" value="0" checked>
                        <label for="food-none">
                            <img class="food-img" src="/icons/noneFood.jpg">
                            No food</label><br>
                        <input type="radio" name="food" id="food-rice" value="10">
                        <label for="food-rice">
                            <img class="food-img" src="/icons/chicken-rice.jpg">
                            Chicken rice + free drink</label><br>
                        <input type="radio" name="food" id="food-noodle" value="15">
                        <label for="food-noodle">
                            <img class="food-img" src="/icons/noodle.jpg">
                            Singapore Noodle + free drink</label><br>
                    </div>

                    <div class="services-options">
                        <h2>Additional Services:</h2>
                        <div>
                            <h4>Priority Check-in:</h4>
                            <input type="checkbox" name="priority" id="priority-checkin-true" value="true">
                            <label for="priority-checkin-true">Priority Check-in : $50</label>
                            <input type="checkbox" name="priority" id="priority-checkin-false" value="false" checked style="display: none;">
                        </div>
                        <br/>
                        <div>
                            <h4>Insurance:</h4>
                            <input type="checkbox" name="insurance" id="insurance-true" value="true">
                            <label for="insurance-true">Insurance : $100</label>
                            <input type="checkbox" name="insurance" id="insurance-false" value="false" checked style="display: none;">
                        </div>
                    </div>

                    <div class="price">
                        <div class="total">
                            <h3 class="total-text">Total Service Fee (AUD) : <div class="amount">0</div></h3>
                            <input type="text" id="totalFee" class="totalFee" name="totalFee" value="0" readonly>
                        </div>
                    </div>
                    <button type="submit">Next</button>
                </div>
            </div>
        </div>
    </form>

</body>
    
    <script>
        document.addEventListener('DOMContentLoaded', () => {
            let seats = document.querySelector(".all-seats");
            let selectedTicket = null;
            let bookedSeatDisplay = document.querySelector(".booked-seat");

            let previousSeatCost = 0;
            let previousBaggageCost = 0;
            let previousFoodCost = 0;
            let previousPriorityCheckinCost = 0;
            let previousInsuranceCost = 0;

            for (var i = 0; i < 152; i++) {
                let randint = Math.floor(Math.random() * 2);
                let booked = randint === 1 ? "booked" : "";
                seats.insertAdjacentHTML(
                    "beforeend",
                    '<input type="checkbox" name="seat" id="s' + (i + 2) + '" value ="' + (i + 2) + '"/><label for="s' + (i + 2) + '" class="seat ' + booked + '"></label>'
                );
            }

            let tickets = seats.querySelectorAll("input[name='seat']");
            tickets.forEach((ticket) => {
                ticket.addEventListener("change", () => {
                    let amount = Number(document.querySelector(".amount").textContent);
                    amount -= previousSeatCost;
                    previousSeatCost = ticket.checked ? 200 : 0;
                    if (ticket.checked) {
                        if (selectedTicket && selectedTicket !== ticket) {
                            selectedTicket.checked = false;
                        }
                        selectedTicket = ticket;
                        bookedSeatDisplay.textContent = ticket.id.substring(1);
                    } else {
                        bookedSeatDisplay.textContent = "";
                    }
                    amount += previousSeatCost;
                    document.querySelector(".amount").textContent = amount;
                    document.querySelector(".totalFee").value = amount;
                });
            });

            let baggageOptions = document.querySelectorAll("input[name='baggage']");
            baggageOptions.forEach((option) => {
                option.addEventListener("change", () => {
                    let amount = Number(document.querySelector(".amount").textContent);
                    amount -= previousBaggageCost;
                    previousBaggageCost = option.checked ? Number(option.value) : 0;
                    amount += previousBaggageCost;
                    document.querySelector(".amount").textContent = amount;
                    document.querySelector(".totalFee").value = amount;
                });
            });

          
            let foodOptions = document.querySelectorAll("input[name='food']");
            foodOptions.forEach((option) => {
                option.addEventListener("change", () => {
                    let amount = Number(document.querySelector(".amount").textContent);
                    amount -= previousFoodCost;
                    previousFoodCost = option.checked ? Number(option.value) : 0;
                    amount += previousFoodCost;
                    document.querySelector(".amount").textContent = amount;
                    document.querySelector(".totalFee").value = amount;
                });
            });

          

            let priorityCheckinCheckbox = document.getElementById("priority-checkin-true");
            priorityCheckinCheckbox.addEventListener("change", () => {
                let amount = Number(document.querySelector(".amount").textContent);
                amount -= previousPriorityCheckinCost;
                previousPriorityCheckinCost = priorityCheckinCheckbox.checked ? 50 : 0;
                if (priorityCheckinCheckbox.checked) {
                    document.getElementById('priority-checkin-false').checked = false;
                }
                amount += previousPriorityCheckinCost;
                document.querySelector(".amount").textContent = amount;
                document.querySelector(".totalFee").value = amount;
            });

            let insuranceCheckbox = document.getElementById("insurance-true");
            insuranceCheckbox.addEventListener("change", () => {
                let amount = Number(document.querySelector(".amount").textContent);
                amount -= previousInsuranceCost;
                previousInsuranceCost = insuranceCheckbox.checked ? 100 : 0;
                if (insuranceCheckbox.checked) {
                    document.getElementById('insurance-false').checked = false;
                }
                amount += previousInsuranceCost;
                document.querySelector(".amount").textContent = amount;
                document.querySelector(".totalFee").value = amount;
            });
        });
    </script>

<%- include('footer'); %>
